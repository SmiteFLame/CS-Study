# Stream

파일이나 콘솔의 입출력을 직접 다루지 않고, Stream이라는 흐름을 통해 다룬다.

- 실제의 입력이나 출력이 표현된 데이터의 이상화된 흐름을 의미한다.
- OS에 생성되는 가상의 연결고리를 의미, 중간 매개자 역할을 한다.

- 즉 데이터의 흐름을 의미한다.

## 기존 데이터 방식의 흐름

1. Application의 Request
2. DB에 Query
3. Application의 데이터 요청
4. Application에서 데이터 처리
5. Event 응답

- 데이터 베이스에서 조회한 데이터들도 메모리에 저장하며 응답을 위한 데이터를 생성하여 데이터를 응답한다
- 한 번의 요청에 대한 처리를 위하 많은 데이터가 어플리케이션에 저장이 된다.

### Stream vs Collection 차이

- Collection: 현재 자료구조가 포함하는 모든 데이터를 메모리에 저장하는 자료구조
  - 각 요소들은 포함이 되기전에 꼭 계산이 완료되어야 한다.
- Stream: 요청할 때만 요소를 계산하는 고정된 자료구조(요소 추가, 삭제 불가) 이다

## Reactive Stream 이란

non-blocking, backPressure을 이용하여 비동기 서비스를 할 때 기본이 되는 스팩

- 비동기 처리를 하면서 가장 중요한 문제는 데이터 처리가 목적지의 리소스 소비를 예측가능한 범위에서 신중하게 제어할 수 있어야 한다.
- 비동기의 경계를 명확히 하여 데이터 교환을 효과적으로 관리한다.

- 특정 사이즈를 가진 데이터를 버퍼하도록 강요하지 않으면서 비동기 thread 경계 사이로 스트림 데이터 교환을 관리하는 것

## Back Pressure

### Push 방식

Publisher가 Event를 Consume하는 Subscriber에게 이벤트를 보내는 방식

- 이벤트를 보내는 쪽과 받는 쪽의 속도를 생각해야 한다.
- 대기하는 이벤트를 위한 Queue가 필요

### Pull 방식

Event를 처리하는 Subscriber가 반대로 자신이 처리할 사이즈의 Event를 Publisher에게 요청하는 방식

- Publisher는 요청 받은 만큼만 전달하면 된다.

## 특징

1. 람다식으로 요소 처리 코드를 제공한다.
2. 내부 반복자를 사용하므로 병렬 처리가 쉽다
3. 중간 처리와 최종 처리가 존재한다.

## Akka Stream

### Source

- Output, 데이터를 발생시켜 다운 스트림으로 흐르게 한다.
- 데이터가 발생이 되는 시점
- Kafka, MQ와 같은 것

### Sink

- Input, 데이터가 끝나는 지점, 데이터를 처리하는 시점
- 데이터를 DB에 저장하는 것들

### Flow

- 하나의 Input, 하나의 Output
- 데이터를 변경한다.
